\newcommand{\todo}[1]{\textbf{\textcolor{red}{TODO: #1}}}

%\def\pinv{\dag}

\DeclareMathOperator*{\argmin}{\arg\min}
\DeclareMathOperator*{\argmax}{\arg\max}


\def\X{{\mathcal X}}
\def\H{{\mathcal H}}
\def\Y{{\mathcal Y}}
\def\D{{\mathcal D}}
\def\L{{\mathcal L}}
\def\F{{\mathcal F}}
\def\mP{{\mathcal P}}
\def\reals{{\mathbb R}}
\def\R{{\mathcal R}}
\def\fhat{{\ensuremath{\hat{f}}}}
\def\mH{\mathcal{H}}
\newcommand{\at}{\makeatletter @\makeatother}

\DeclareMathOperator{\clip}{clip}
\def\norm#1{\mathopen\| #1 \mathclose\|}% use instead of $\|x\|$

\newcommand{\proj}{\mathop{\Pi}}

\newcommand{\err}{\mathop{\mbox{\rm error}}}
\newcommand{\rank}{\mathop{\mbox{\rm rank}}}
\newcommand{\ellipsoid}{{\mathcal E}}
\newcommand{\sround}{\mathop{\mbox{\rm SmartRound}}}
\newcommand{\round}{\mathop{\mbox{\rm round}}}
\newcommand{\myspan}{\mathop{\mbox{\rm span}}}
\newcommand{\edges}{\mathop{\mbox{\rm edges}}}
\newcommand{\conv}{\mathop{\mbox{\rm conv}}}
\newcommand{\sign}{\mathop{\mbox{\rm sign}}}
\newcommand{\poly}{\mathop{\mbox{\rm poly}}}

\newcommand{\ignore}[1]{}
\newcommand{\equaldef}{\stackrel{\text{\tiny def}}{=}}
\newcommand{\equaltri}{\triangleq}
\newcommand{\tr}{\ensuremath{{\scriptscriptstyle\mathsf{T}}}}
\def\trace{{\bf Tr}}
\def\dist{{\bf P}}
\def\mydist{{\bf Q}}
\def\reals{{\mathbb R}}
\newcommand{\E}{\mathop{\mbox{\bf E}}}
\newcommand\ball{\mathbb{B}}
\newcommand\var{\mbox{Var}}
\def\bzero{\mathbf{0}}

\def\Exp{\mathop{\mbox{E}}}
\def\mP{{\mathcal P}}
\def\risk{{\mbox{Risk}}}
\def\ent{{\mbox{ent}}}
\def\mG{{\mathcal G}}
\def\mA{{\mathcal A}}
\def\V{{\mathcal V}}
\def\lhat{\hat{\ell}}
\def\Lhat{\hat{L}}
\def\ltil{\tilde{\ell}}
\def\Ltil{\tilde{L}}

\def\Ahat{\hat{\mathbf{A}}}

\def\bold0{\mathbf{0}}
\def\boldone{\mathbf{1}}
\def\boldp{\mathbf{p}}
\def\boldq{\mathbf{q}}
\def\boldr{\mathbf{r}}
\def\boldA{\mathbf{A}}
\def\boldI{\mathbf{I}}
\newcommand\mycases[4] {{
\left\{
\begin{array}{ll}
    {#1}, & {#2} \\\\
    {#3}, & {#4}
\end{array}
\right. }}
\newcommand\mythreecases[6] {{
\left\{
\begin{array}{ll}
    {#1}, & {#2} \\\\
    {#3}, & {#4} \\\\
    {#5}, & {#6}
\end{array}
\right. }}
\def\bb{\mathbf{b}}
\def\bc{\mathbf{c}}
\def\bB{\mathbf{B}}
\def\bC{\mathbf{C}}
\def\be{\mathbf{e}}
\def\etil{\tilde{\mathbf{e}}}
\def\bk{\mathbf{k}}
\def\bu{\mathbf{u}}
\def\bx{\mathbf{x}}
\def\w{\mathbf{w}}
\def\by{\mathbf{y}}
\def\bz{\mathbf{z}}
\def\bp{\mathbf{p}}
\def\bq{\mathbf{q}}
\def\br{\mathbf{r}}
\def\bu{\mathbf{u}}
\def\bv{\mathbf{v}}

\def\bw{\mathbf{w}}
\def\ba{\mathbf{a}}
\def\bA{\mathbf{A}}
\def\bB{\mathbf{B}}
\def\bC{\mathbf{C}}
\def\bD{\mathbf{D}}
\def\bS{\mathbf{S}}
\def\bG{\mathbf{G}}
\def\bI{\mathbf{I}}
\def\bJ{\mathbf{J}}
\def\bP{\mathbf{P}}
\def\bQ{\mathbf{Q}}
\def\bV{\mathbf{V}}
\def\bone{\mathbf{1}}


\def\xhat{\hat{\mathbf{x}}}
\def\xbar{\bar{\mathbf{x}}}
\def\vol{\mbox{vol}}
\def\trace{{\bf Tr}}
\def\Exp{\mathop{\mbox{E}}}
\newcommand{\val}{\mathop{\mbox{\rm val}}}
\renewcommand{\deg}{\mathop{\mbox{\rm deg}}}
\newcommand{\eps}{\varepsilon}

% Macros for this chapter
\def\bone{\mathbf{1}}
\newcommand{\sphere}{\ensuremath{\mathbb {S}}}
\newcommand{\simplex}{\ensuremath{\Delta}}
\newcommand{\diag}{\mbox{diag}}
\newcommand{\K}{\ensuremath{\mathcal K}}
\newcommand{\Ktil}{\ensuremath{\mathcal{\tilde{K}}}}
\def\mA{{\mathcal A}}
\newcommand{\x}{\ensuremath{\mathbf x}}
\newcommand{\vn}{\ensuremath{\mathbf n}}
\newcommand{\rv}[1][t]{\ensuremath{\mathbf r_{#1}}}
\newcommand{\y}{\ensuremath{\mathbf y}}
\newcommand{\z}{\ensuremath{\mathbf z}}
\newcommand{\h}{\ensuremath{\mathbf h}}
\newcommand{\xtil}[1][t]{\ensuremath{\mathbf {\tilde{x}}_{#1}}}
\newcommand{\xv}[1][t]{\ensuremath{\mathbf x_{#1}}}
\newcommand{\xvh}[1][t]{\ensuremath{\mathbf {\hat x}}_{#1}}
\newcommand{\ftildeh}[1][t]{\ensuremath{\mathbf {\hat f}}_{#1}}
\newcommand{\xvbar}[1][t]{\ensuremath{\bar{\mathbf x}_{#1}}}
\newcommand{\xstar}{\ensuremath{\mathbf x^{*}}}
\newcommand{\xstarr}{\ensuremath{\mathbf x^{\star}}}
\newcommand{\yv}[1][t]{\ensuremath{\mathbf y_{#1}}}
\newcommand{\zv}[1][t]{\ensuremath{\mathbf z_{#1}}}
\newcommand{\fv}[1][t]{\ensuremath{\mathbf f_{#1}}}
\newcommand{\gv}[1][t]{\ensuremath{\mathbf g_{#1}}}
\newcommand{\qv}[1][t]{\ensuremath{\mathbf q_{#1}}}
\newcommand{\pv}[1][t]{\ensuremath{\mathbf p_{#1}}}
\newcommand{\ftilde}[1][t]{\ensuremath{\mathbf {\tilde f}_{#1}}}
\newcommand{\gtilde}[1][t]{\ensuremath{\mathbf {\tilde g}_{#1}}}
\newcommand{\ev}[1][i]{\ensuremath{\mathbf e_{#1}}}
\newcommand{\uv}{\ensuremath{\mathbf u}}
\newcommand{\vv}{\ensuremath{\mathbf v}}
\newcommand{\A}[1][t]{\ensuremath{\mathbf A_{#1}}}
\newcommand{\Ftilde}[1][t]{\ensuremath{\mathbf {\tilde F}_{#1}}}
\newcommand{\Gtilde}[1][t]{\ensuremath{\mathbf {\tilde G}_{#1}}}
\newcommand{\hessum}[1][t]{\ensuremath{\boldsymbol{H}_{1:#1}}}
\newcommand{\reg}[1][t]{\ensuremath{\lambda_{#1}}}
\newcommand{\regsum}[1][t]{\ensuremath{\boldsymbol{\lambda}_{1:#1}}}
\newcommand{\bM}{\ensuremath{\mathcal M}}
%\newcommand{\F}{\ensuremath{\mathcal F}}
\newcommand{\ntil}{\tilde{\nabla}}
\newcommand{\Ftil}{\tilde{F}}
\newcommand{\ftil}{\tilde{f}}
\newcommand{\rhotil}{\tilde{\rho}}
\newcommand{\gtil}{\tilde{g}}
\newcommand{\mutil}{\tilde{\mu}}
\newcommand{\Atil}{\tilde{A}}
\newcommand{\Qtil}{\tilde{Q}}
\newcommand{\vtil}{\tilde{v}}
\newcommand\super[1] {{^{(#1)}}}
\def\regret{\ensuremath{\mathrm{{regret}}}}
%\def\regretEM{\ensuremath{\text{\em regret}}}
\def\bb{\mathbf{b}}
\def\be{\mathbf{e}}
\def\bu{\mathbf{u}}
\def\bx{\mathbf{x}}
\def\by{\mathbf{y}}
\def\bz{\mathbf{z}}
\def\bp{\mathbf{p}}
\def\bdelta{\mathbf{\delta}}
\def\bq{\mathbf{q}}
\def\br{\mathbf{r}}
\def\bv{\mathbf{v}}
\def\ba{\mathbf{a}}
\def\bI{\mathbf{I}}
\def\bJ{\mathbf{J}}
\def\bP{\mathbf{P}}
\def\bV{\mathbf{V}}
\def\sgn{\text{sgn}}
\def\eps{\varepsilon}
\def\epsilon{\varepsilon}
\def\tsum{{\textstyle \sum}}

%\def\ogd{{\sc Online Gradient Descent}\xspace}
\def\ogd{{online gradient descent}\xspace}
\def\R{\ensuremath{\mathcal R}}

